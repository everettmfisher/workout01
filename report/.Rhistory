ggplot(team_salaries, aes(x = reorder(team, total_salary), y = total_salary)) + geom_col() + coord_flip() + labs(y = "Total Salary ($ millions)", x = "Team", title = "Total NBA Salaries by Team") + geom_hline(yintercept = mean(team_salaries$total_salary), color = "red") + geom_text(aes(25, mean(team_salaries$total_salary)), label = "Average total salary")
# barchart of total salary by team
ggplot(team_salaries, aes(x = reorder(team, total_salary), y = total_salary)) + geom_col() + coord_flip() + labs(y = "Total Salary ($ millions)", x = "Team", title = "Total NBA Salaries by Team") + geom_hline(yintercept = mean(team_salaries$total_salary), color = "red") + geom_text(aes(0, mean(team_salaries$total_salary)), label = "Average total salary")
# barchart of total salary by team
ggplot(team_salaries, aes(x = reorder(team, total_salary), y = total_salary)) + geom_col() + coord_flip() + labs(y = "Total Salary ($ millions)", x = "Team", title = "Total NBA Salaries by Team") + geom_hline(yintercept = mean(team_salaries$total_salary), color = "red") + geom_text(aes(2, mean(team_salaries$total_salary)), label = "Average total salary")
# barchart of total salary by team
ggplot(team_salaries, aes(x = reorder(team, total_salary), y = total_salary)) + geom_col() + coord_flip() + labs(y = "Total Salary ($ millions)", x = "Team", title = "Total NBA Salaries by Team") + geom_hline(yintercept = mean(team_salaries$total_salary), color = "red") + geom_text(aes(4, mean(team_salaries$total_salary) + 4), label = "Mean total salary")
# barchart of total salary by team
ggplot(team_salaries, aes(x = reorder(team, total_salary), y = total_salary)) + geom_col() + coord_flip() + labs(y = "Total Salary ($ millions)", x = "Team", title = "Total NBA Salaries by Team") + geom_hline(yintercept = mean(team_salaries$total_salary), color = "red") + geom_text(aes(x = 4, y = mean(team_salaries$total_salary) + 4), label = "Mean total salary")
# barchart of total salary by team
ggplot(team_salaries, aes(x = reorder(team, total_salary), y = total_salary)) + geom_col() + coord_flip() + labs(y = "Total Salary ($ millions)", x = "Team", title = "Total NBA Salaries by Team") + geom_hline(yintercept = mean(team_salaries$total_salary), color = "red") + geom_text(aes(x = 4, y = mean(team_salaries$total_salary) + 10), label = "Mean total salary")
# barchart of total salary by team
ggplot(team_salaries, aes(x = reorder(team, total_salary), y = total_salary)) + geom_col() + coord_flip() + labs(y = "Total Salary ($ millions)", x = "Team", title = "Total NBA Salaries by Team") + geom_hline(yintercept = mean(team_salaries$total_salary), color = "red") + geom_text(aes(x = 4, y = mean(team_salaries$total_salary) + 15), label = "Mean total salary")
# barchart of total salary by team
ggplot(team_salaries, aes(x = reorder(team, total_salary), y = total_salary)) + geom_col() + coord_flip() + labs(y = "Total Salary ($ millions)", x = "Team", title = "Total NBA Salaries by Team") + geom_hline(yintercept = mean(team_salaries$total_salary), color = "red") + geom_text(aes(x = 4, y = mean(team_salaries$total_salary) + 20), label = "Mean total salary")
# barchart of total salary by team
ggplot(team_salaries, aes(x = reorder(team, total_salary), y = total_salary)) + geom_col() + coord_flip() + labs(y = "Total Salary ($ millions)", x = "Team", title = "Total NBA Salaries by Team") + geom_hline(yintercept = mean(team_salaries$total_salary), color = "red") + geom_text(aes(x = 4, y = mean(team_salaries$total_salary) + 10), label = "Mean total salary")
# barchart of total salary by team
ggplot(team_salaries, aes(x = reorder(team, total_salary), y = total_salary)) + geom_col() + coord_flip() + labs(y = "Total Salary ($ millions)", x = "Team", title = "NBA Teams Ranked by Total Salary") + geom_hline(yintercept = mean(team_salaries$total_salary), color = "red") + geom_text(aes(x = 4, y = mean(team_salaries$total_salary) + 10), label = "Mean total salary")
team_points <- summarize(
group_by(dat, team),
total_points = sum(points),
mean_points = mean(points),
median_points = median(points)
)
team_points <- arrange(team_points, desc(total_points))
as.data.frame(team_points)
# barchart of total points by team
ggplot(team_points, aes(x = reorder(team, total_points), y = total_points)) + geom_col() + coord_flip() + labs(y = "Total Points", x = "Team", title = "NBA Teams Ranked by Total Scored Points") + geom_hline(yintercept = mean(team_points$total_points), color = "red") + geom_text(aes(x = 4, y = mean(team_salaries$total_salary) + 10), label = "Mean total points")
# barchart of total points by team
ggplot(team_points, aes(x = reorder(team, total_points), y = total_points)) + geom_col() + coord_flip() + labs(y = "Total Points", x = "Team", title = "NBA Teams Ranked by Total Scored Points") + geom_hline(yintercept = mean(team_points$total_points), color = "red") + geom_text(aes(x = 4, y = mean(team_points$total_points) + 10), label = "Mean total points")
# barchart of total points by team
ggplot(team_points, aes(x = reorder(team, total_points), y = total_points)) + geom_col() + coord_flip() + labs(y = "Total Points", x = "Team", title = "NBA Teams Ranked by Total Scored Points") + geom_hline(yintercept = mean(team_points$total_points), color = "red") + geom_text(aes(x = 4, y = mean(team_points$total_points) + 100), label = "Mean total points")
# barchart of total points by team
ggplot(team_points, aes(x = reorder(team, total_points), y = total_points)) + geom_col() + coord_flip() + labs(y = "Total Points", x = "Team", title = "NBA Teams Ranked by Total Scored Points") + geom_hline(yintercept = mean(team_points$total_points), color = "red") + geom_text(aes(x = 4, y = mean(team_points$total_points) + 1000), label = "Mean total points")
# barchart of total points by team
ggplot(team_points, aes(x = reorder(team, total_points), y = total_points)) + geom_col() + coord_flip() + labs(y = "Total Points", x = "Team", title = "NBA Teams Ranked by Total Scored Points") + geom_hline(yintercept = mean(team_points$total_points), color = "red") + geom_text(aes(x = 4, y = mean(team_points$total_points) + 500), label = "Mean total points")
# barchart of total points by team
ggplot(team_points, aes(x = reorder(team, total_points), y = total_points)) + geom_col() + coord_flip() + labs(y = "Total Points", x = "Team", title = "NBA Teams Ranked by Total Scored Points") + geom_hline(yintercept = mean(team_points$total_points), color = "red") + geom_text(aes(x = 4, y = mean(team_points$total_points) + 700), label = "Mean total points")
left_join(team_salaries, team_points)
points_salary <- inner_join(team_salaries, team_points)
points_salary <- inner_join(team_salaries, team_points, by = "team")
points_salary
library(knitr)
library(readr)
library(dplyr)
library(ggplot2)
points_salary <- inner_join(team_salaries, team_points, by = "team")
library(knitr)
library(readr)
library(dplyr)
library(ggplot2)
datafile <- "https://raw.githubusercontent.com/ucb-stat133/stat133-hws/master/data/nba2018-players.csv"
dat <- read_csv(datafile, col_names = TRUE, col_types = cols("c", "c", "f", "i", "i", "i", "i", "c", "d", "i", "i", "i", "i", "i", "i"))
summary(dat)
typeof(dat)
team_salaries <- summarize(
group_by(dat, team),
total_salary = sum(salary) / 1000000,
mean_salary = mean(salary) / 1000000,
median_salary = median(salary) / 1000000
)
team_salaries <- arrange(team_salaries, desc(total_salary))
as.data.frame(team_salaries)
# barchart of total salary by team
ggplot(team_salaries, aes(x = reorder(team, total_salary), y = total_salary)) + geom_col() + coord_flip() + labs(y = "Total Salary ($ millions)", x = "Team", title = "NBA Teams Ranked by Total Salary") + geom_hline(yintercept = mean(team_salaries$total_salary), color = "red") + geom_text(aes(x = 4, y = mean(team_salaries$total_salary) + 10), label = "Mean total salary")
team_points <- summarize(
group_by(dat, team),
total_points = sum(points),
mean_points = mean(points),
median_points = median(points)
)
team_points <- arrange(team_points, desc(total_points))
as.data.frame(team_points)
# barchart of total points by team
ggplot(team_points, aes(x = reorder(team, total_points), y = total_points)) + geom_col() + coord_flip() + labs(y = "Total Points", x = "Team", title = "NBA Teams Ranked by Total Scored Points") + geom_hline(yintercept = mean(team_points$total_points), color = "red") + geom_text(aes(x = 4, y = mean(team_points$total_points) + 700), label = "Mean total points")
points_salary <- inner_join(team_salaries, team_points, by = "team")
summary(points_salary)
points_salary <- mutate(points_salary, cost_point = total_salary / total_points)
summary(select(points_Salary, cost_point))
summary(select(points_salary, cost_point))
points_salary <- inner_join(team_salaries, team_points, by = "team")
summary(points_salary)
points_salary <- mutate(points_salary, cost_point = (total_salary / total_points) * 1000000)
summary(select(points_salary, cost_point))
# barchart of cost per point by team
ggplot(team_points, aes(x = reorder(team, cost_point), y = cost_point)) + geom_col() + coord_flip() + labs(y = "Cost per Point ($)", x = "Team", title = "Cost per Point Scored by NBA Teams") + geom_hline(yintercept = median(team_points$cost_point), color = "red") + geom_text(aes(x = 4, y = median(team_points$total_points) + 700), label = "Median cost per point")
points_salary <- inner_join(team_salaries, team_points, by = "team")
summary(points_salary)
points_salary <- mutate(points_salary, cost_point = (total_salary / total_points) * 1000000)
summary(select(points_salary, cost_point))
# barchart of cost per point by team
ggplot(team_points, aes(x = reorder(team, cost_point), y = cost_point)) + geom_col() + coord_flip() + labs(y = "Cost per Point ($)", x = "Team", title = "Cost per Point Scored by NBA Teams") + geom_hline(yintercept = median(team_points$cost_point), color = "red") + geom_text(aes(x = 4, y = median(team_points$total_points) + 700), label = "Median cost per point")
# barchart of cost per point by team
ggplot(team_points, aes(x = reorder(team, cost_point), y = cost_point)) + geom_col() + coord_flip() + labs(y = "Cost per Point ($)", x = "Team", title = "Cost per Point Scored by NBA Teams") + geom_hline(yintercept = median(team_points$cost_point), color = "red") + geom_text(aes(x = 4, y = median(team_points$cost_point) + 700), label = "Median cost per point")
# barchart of cost per point by team
ggplot(points_salary, aes(x = reorder(team, cost_point), y = cost_point)) + geom_col() + coord_flip() + labs(y = "Cost per Point ($)", x = "Team", title = "Cost per Point Scored by NBA Teams") + geom_hline(yintercept = median(poinst_salary$cost_point), color = "red") + geom_text(aes(x = 4, y = median(points_salary$cost_point) + 700), label = "Median cost per point")
# barchart of cost per point by team
ggplot(points_salary, aes(x = reorder(team, cost_point), y = cost_point)) + geom_col() + coord_flip() + labs(y = "Cost per Point ($)", x = "Team", title = "Cost per Point Scored by NBA Teams") + geom_hline(yintercept = median(points_salary$cost_point), color = "red") + geom_text(aes(x = 4, y = median(points_salary$cost_point) + 700), label = "Median cost per point")
library(knitr)
library(readr)
library(dplyr)
library(ggplot2)
datafile <- "https://raw.githubusercontent.com/ucb-stat133/stat133-hws/master/data/nba2018-players.csv"
dat <- read_csv(datafile, col_names = TRUE, col_types = cols("c", "c", "f", "i", "i", "i", "i", "c", "d", "i", "i", "i", "i", "i", "i"))
summary(dat)
typeof(dat)
team_salaries <- summarize(
group_by(dat, team),
total_salary = sum(salary) / 1000000,
mean_salary = mean(salary) / 1000000,
median_salary = median(salary) / 1000000
)
team_salaries <- arrange(team_salaries, desc(total_salary))
as.data.frame(team_salaries)
# barchart of total salary by team
ggplot(team_salaries, aes(x = reorder(team, total_salary), y = total_salary)) + geom_col() + coord_flip() + labs(y = "Total Salary ($ millions)", x = "Team", title = "NBA Teams Ranked by Total Salary") + geom_hline(yintercept = mean(team_salaries$total_salary), color = "red") + geom_text(aes(x = 4, y = mean(team_salaries$total_salary) + 10), label = "Mean total salary")
team_points <- summarize(
group_by(dat, team),
total_points = sum(points),
mean_points = mean(points),
median_points = median(points)
)
team_points <- arrange(team_points, desc(total_points))
as.data.frame(team_points)
# barchart of total points by team
ggplot(team_points, aes(x = reorder(team, total_points), y = total_points)) + geom_col() + coord_flip() + labs(y = "Total Points", x = "Team", title = "NBA Teams Ranked by Total Scored Points") + geom_hline(yintercept = mean(team_points$total_points), color = "red") + geom_text(aes(x = 4, y = mean(team_points$total_points) + 700), label = "Mean total points")
points_salary <- inner_join(team_salaries, team_points, by = "team")
summary(points_salary)
points_salary <- mutate(points_salary, cost_point = (total_salary / total_points) * 1000000)
summary(select(points_salary, cost_point))
# barchart of cost per point by team
points_salary <- mutate(points_salary, percentile = quantile(points_salary$cost_point, probs = c(0, 0.25, 0.5, 0.75, 1)))
# barchart of cost per point by team
percentile = quantile(points_salary$cost_point, probs = c(0, 0.25, 0.5, 0.75, 1))
ggplot(points_salary, aes(x = reorder(team, cost_point), y = cost_point)) + geom_col() + coord_flip() + labs(y = "Cost per Point ($)", x = "Team", title = "Cost per Point Scored by NBA Teams") + geom_hline(yintercept = median(points_salary$cost_point), color = "red") + geom_text(aes(x = 4, y = median(points_salary$cost_point) + 700), label = "Median cost per point")
points_salary <- mutate(points_salary, cost_quant = factor(findInterval(points_salary$cost_point, percentile)))
View(points_salary)
# barchart of cost per point by team
percentile = quantile(points_salary$cost_point, probs = c(0, 0.25, 0.5, 0.75, 1))
points_salary <- mutate(points_salary, cost_quant = factor(findInterval(points_salary$cost_point, percentile, all.inside = TRUE)))
ggplot(points_salary, aes(x = reorder(team, cost_point), y = cost_point)) + geom_col() + coord_flip() + labs(y = "Cost per Point ($)", x = "Team", title = "Cost per Point Scored by NBA Teams") + geom_hline(yintercept = median(points_salary$cost_point), color = "red") + geom_text(aes(x = 4, y = median(points_salary$cost_point) + 700), label = "Median cost per point")
View(points_salary)
View(points_salary)
# barchart of cost per point by team
percentile = quantile(points_salary$cost_point, probs = c(0, 0.25, 0.5, 0.75, 1))
points_salary <- mutate(points_salary, cost_quant = factor(findInterval(points_salary$cost_point, percentile, all.inside = TRUE)))
ggplot(points_salary, aes(x = reorder(team, cost_point), y = cost_point, color = cost_quant)) + geom_col() + coord_flip() + labs(y = "Cost per Point ($)", x = "Team", title = "Cost per Point Scored by NBA Teams") + geom_hline(yintercept = median(points_salary$cost_point), color = "red") + geom_text(aes(x = 4, y = median(points_salary$cost_point) + 700), label = "Median cost per point")
# barchart of cost per point by team
percentile = quantile(points_salary$cost_point, probs = c(0, 0.25, 0.5, 0.75, 1))
points_salary <- mutate(points_salary, cost_quant = factor(findInterval(points_salary$cost_point, percentile, all.inside = TRUE)))
levels(Points_salary$cost_quant) <- c("<25th percentile", "25-50th percentile", "50-75th percentile", ">75th percentile")
# barchart of cost per point by team
percentile = quantile(points_salary$cost_point, probs = c(0, 0.25, 0.5, 0.75, 1))
points_salary <- mutate(points_salary, cost_quant = factor(findInterval(points_salary$cost_point, percentile, all.inside = TRUE)))
levels(points_salary$cost_quant) <- c("<25th percentile", "25-50th percentile", "50-75th percentile", ">75th percentile")
ggplot(points_salary, aes(x = reorder(team, cost_point), y = cost_point, color = cost_quant)) + geom_col() + coord_flip() + labs(y = "Cost per Point ($)", x = "Team", title = "Cost per Point Scored by NBA Teams") + geom_hline(yintercept = median(points_salary$cost_point), color = "red") + geom_text(aes(x = 4, y = median(points_salary$cost_point) + 700), label = "Median cost per point")
# barchart of cost per point by team
percentile = quantile(points_salary$cost_point, probs = c(0, 0.25, 0.5, 0.75, 1))
points_salary <- mutate(points_salary, cost_quant = factor(findInterval(points_salary$cost_point, percentile, all.inside = TRUE)))
levels(points_salary$cost_quant) <- c("<25th percentile", "25-50th percentile", "50-75th percentile", ">75th percentile")
ggplot(points_salary, aes(x = reorder(team, cost_point), y = cost_point, fill = cost_quant)) + geom_col() + coord_flip() + labs(y = "Cost per Point ($)", x = "Team", title = "Cost per Point Scored by NBA Teams") + geom_hline(yintercept = median(points_salary$cost_point), color = "red") + geom_text(aes(x = 4, y = median(points_salary$cost_point) + 700), label = "Median cost per point")
ggplot(points_salary, aes(x = reorder(team, cost_point), y = cost_point, fill = cost_quant)) + geom_col() + coord_flip() + labs(y = "Cost per Point ($)", x = "Team", title = "Cost per Point Scored by NBA Teams") + geom_hline(yintercept = median(points_salary$cost_point), color = "red") + geom_text(aes(x = 4, y = median(points_salary$cost_point) + 700), label = "Median cost per point") + theme_bw()
ggplot(points_salary, aes(x = reorder(team, cost_point), y = cost_point, fill = cost_quant)) + geom_col() + coord_flip() + labs(y = "Cost per Point ($)", x = "Team", title = "Cost per Point Scored by NBA Teams") + geom_hline(yintercept = median(points_salary$cost_point), color = "red") + geom_text(aes(x = 4, y = median(points_salary$cost_point) + 700), label = print("Median cost per point:", median(points_salary$cost_point) + theme_bw()
ggplot(points_salary, aes(x = reorder(team, cost_point), y = cost_point, fill = cost_quant)) + geom_col() + coord_flip() + labs(y = "Cost per Point ($)", x = "Team", title = "Cost per Point Scored by NBA Teams") + geom_hline(yintercept = median(points_salary$cost_point), color = "red") + geom_text(aes(x = 4, y = median(points_salary$cost_point) + 700), label = print("Median cost per point:", median(points_salary$cost_point)) + theme_bw()
ggplot(points_salary, aes(x = reorder(team, cost_point), y = cost_point, fill = cost_quant)) + geom_col() + coord_flip() + labs(y = "Cost per Point ($)", x = "Team", title = "Cost per Point Scored by NBA Teams") + geom_hline(yintercept = median(points_salary$cost_point), color = "red") + geom_text(aes(x = 4, y = median(points_salary$cost_point) + 700), label = c("Median cost per point:", median(points_salary$cost_point)) + theme_bw()
ggplot(points_salary, aes(x = reorder(team, cost_point), y = cost_point, fill = cost_quant)) + geom_col() + coord_flip() + labs(y = "Cost per Point ($)", x = "Team", title = "Cost per Point Scored by NBA Teams") + geom_hline(yintercept = median(points_salary$cost_point), color = "red") + geom_text(aes(x = 4, y = median(points_salary$cost_point) + 700), label = paste("Median cost per point:", median(points_salary$cost_point), collapse = " ") + theme_bw()
# barchart of cost per point by team
percentile = quantile(points_salary$cost_point, probs = c(0, 0.25, 0.5, 0.75, 1))
points_salary <- mutate(points_salary, cost_quant = factor(findInterval(points_salary$cost_point, percentile, all.inside = TRUE)))
levels(points_salary$cost_quant) <- c("<25th percentile", "25-50th percentile", "50-75th percentile", ">75th percentile")
ggplot(points_salary, aes(x = reorder(team, cost_point), y = cost_point, fill = cost_quant)) + geom_col() + coord_flip() + labs(y = "Cost per Point ($)", x = "Team", title = "Cost per Point Scored by NBA Teams") + geom_hline(yintercept = median(points_salary$cost_point), color = "red") + geom_text(aes(x = 4, y = median(points_salary$cost_point) + 700), label = paste("Median cost per point:", median(points_salary$cost_point), collapse = " ") + theme_bw()
ggplot(points_salary, aes(x = reorder(team, cost_point), y = cost_point, fill = cost_quant)) + geom_col() + coord_flip() + labs(y = "Cost per Point ($)", x = "Team", title = "Cost per Point Scored by NBA Teams") + geom_hline(yintercept = median(points_salary$cost_point), color = "red") + geom_text(aes(x = 4, y = median(points_salary$cost_point) + 700), label = paste("Median cost per point:", median(points_salary$cost_point), collapse = " ")) + theme_bw()
ggplot(points_salary, aes(x = reorder(team, cost_point), y = cost_point, fill = cost_quant)) + geom_col() + coord_flip() + labs(y = "Cost per Point ($)", x = "Team", title = "Cost per Point Scored by NBA Teams") + geom_hline(yintercept = median(points_salary$cost_point), color = "red") + geom_text(aes(x = 4, y = median(points_salary$cost_point) + 700), label = paste("Median cost per point: $", median(points_salary$cost_point), collapse = "")) + theme_bw()
ggplot(points_salary, aes(x = reorder(team, cost_point), y = cost_point, fill = cost_quant)) + geom_col() + coord_flip() + labs(y = "Cost per Point ($)", x = "Team", title = "Cost per Point Scored by NBA Teams") + geom_hline(yintercept = median(points_salary$cost_point), color = "red") + geom_text(aes(x = 4, y = median(points_salary$cost_point) + 700), label = paste("Median cost per point: $", as.integer(median(points_salary$cost_point)), collapse = "")) + theme_bw()
# barchart of cost per point by team
percentile = quantile(points_salary$cost_point, probs = c(0, 0.25, 0.5, 0.75, 1))
points_salary <- mutate(points_salary, cost_quant = factor(findInterval(points_salary$cost_point, percentile, all.inside = TRUE)))
levels(points_salary$cost_quant) <- c("<25th percentile", "25-50th percentile", "50-75th percentile", ">75th percentile")
ggplot(points_salary, aes(x = reorder(team, cost_point), y = cost_point, fill = cost_quant)) + geom_col() + coord_flip() + labs(y = "Cost per Point ($)", x = "Team", title = "Cost per Point Scored by NBA Teams") + geom_hline(yintercept = median(points_salary$cost_point), color = "red") + geom_text(aes(x = 4, y = median(points_salary$cost_point) + 1400), label = paste("Median cost per point: $", as.integer(median(points_salary$cost_point)), collapse = "")) + theme_bw()
ggplot(points_salary, aes(x = reorder(team, cost_point), y = cost_point, fill = cost_quant)) + geom_col() + coord_flip() + labs(y = "Cost per Point ($)", x = "Team", title = "Cost per Point Scored by NBA Teams") + geom_hline(yintercept = median(points_salary$cost_point), color = "red") + geom_text(aes(x = 4, y = median(points_salary$cost_point), label = paste("Median cost per point: $", as.integer(median(points_salary$cost_point)), collapse = "")) + theme_bw()
ggplot(points_salary, aes(x = reorder(team, cost_point), y = cost_point, fill = cost_quant)) + geom_col() + coord_flip() + labs(y = "Cost per Point ($)", x = "Team", title = "Cost per Point Scored by NBA Teams") + geom_hline(yintercept = median(points_salary$cost_point), color = "red") + geom_text(aes(x = 4, y = median(points_salary$cost_point)), label = paste("Median cost per point: $", as.integer(median(points_salary$cost_point)), collapse = "")) + theme_bw()
ggplot(points_salary, aes(x = reorder(team, cost_point), y = cost_point, fill = cost_quant)) + geom_col() + coord_flip() + labs(y = "Cost per Point ($)", x = "Team", title = "Cost per Point Scored by NBA Teams") + geom_hline(yintercept = median(points_salary$cost_point), color = "red") + geom_text(aes(x = 4, y = median(points_salary$cost_point), label = paste("Median cost per point: $", as.integer(median(points_salary$cost_point)), collapse = "")) + theme_bw()
# barchart of cost per point by team
percentile = quantile(points_salary$cost_point, probs = c(0, 0.25, 0.5, 0.75, 1))
# barchart of cost per point by team
percentile = quantile(points_salary$cost_point, probs = c(0, 0.25, 0.5, 0.75, 1))
points_salary <- mutate(points_salary, cost_quant = factor(findInterval(points_salary$cost_point, percentile, all.inside = TRUE)))
levels(points_salary$cost_quant) <- c("<25th percentile", "25-50th percentile", "50-75th percentile", ">75th percentile")
ggplot(points_salary, aes(x = reorder(team, cost_point), y = cost_point, fill = cost_quant)) + geom_col() + coord_flip() + labs(y = "Cost per Point ($)", x = "Team", title = "Cost per Point Scored by NBA Teams") + geom_hline(yintercept = median(points_salary$cost_point), color = "red") + geom_text(aes(x = 4, y = median(points_salary$cost_point), label = paste("Median cost per point: $", as.integer(median(points_salary$cost_point)), collapse = "")) + theme_bw()
ggplot(points_salary, aes(x = reorder(team, cost_point), y = cost_point, fill = cost_quant)) + geom_col() + coord_flip() + labs(y = "Cost per Point ($)", x = "Team", title = "Cost per Point Scored by NBA Teams") + geom_hline(yintercept = median(points_salary$cost_point), color = "red") + geom_text(aes(x = 4, y = median(points_salary$cost_point)), label = paste("Median cost per point: $", as.integer(median(points_salary$cost_point)), collapse = "")) + theme_bw()
# plot of median salary vs. median points scored, colored by quantile of team's cost per point
ggplot(points_salary, aes(x = median_points, y= median_salary)) + geom_point(aes(color = cost_quant))
# barchart of cost per point by team
percentile = quantile(points_salary$cost_point, probs = c(0, 0.25, 0.5, 0.75, 1))
points_salary <- mutate(points_salary, cost_quant = factor(findInterval(points_salary$cost_point, percentile, all.inside = TRUE)))
levels(points_salary$cost_quant) <- c("<25th percentile", "25-50th percentile", "50-75th percentile", ">75th percentile")
ggplot(points_salary, aes(x = reorder(team, cost_point), y = cost_point, fill = cost_quant)) + geom_col() + coord_flip() + labs(y = "Cost per Point ($)", x = "Team", title = "Cost per Point Scored by NBA Teams") + geom_hline(yintercept = median(points_salary$cost_point), color = "red") + geom_text(aes(x = 4, y = median(points_salary$cost_point)), label = paste("Median cost per point: $", as.integer(median(points_salary$cost_point)), collapse = "")) + theme_bw()
View(points_salary)
View(points_salary)
# plot of median salary vs. median points scored, colored by quantile of team's cost per point
ggplot(points_salary, aes(x = median_points, y= median_salary)) + geom_point(aes(color = cost_quant)) + geom_text(aes(label = team))
# plot of median salary vs. median points scored, colored by quantile of team's cost per point
ggplot(points_salary, aes(x = median_points, y= median_salary)) + geom_point(aes(color = cost_quant)) + geom_text(aes(label = team, y = median_salary + .1))
# plot of median salary vs. median points scored, colored by quantile of team's cost per point
ggplot(points_salary, aes(x = median_points, y= median_salary)) + geom_point(aes(color = cost_quant, size = 20)) + geom_text(aes(label = team, y = median_salary + .2))
# plot of median salary vs. median points scored, colored by quantile of team's cost per point
ggplot(points_salary, aes(x = median_points, y= median_salary)) + geom_point(aes(color = cost_quant, size = 20)) + geom_text(aes(label = team, y = median_salary + .2)) + labs( x = "Median points scored per team", y = "Median salary per team", title = "NBA Points vs. Salary", caption = "Colored by team's cost per point quantile")
# plot of median salary vs. median points scored, colored by quantile of team's cost per point
ggplot(points_salary, aes(x = median_points, y= median_salary)) + geom_point(aes(color = cost_quant, size = 20)) + geom_text(aes(label = team, y = median_salary + .2)) + labs( x = "Median points scored per team", y = "Median salary per team", title = "NBA Points vs. Salary", caption = "Colored by team's cost per point quantile") +guides(size = FALSE)
# plot of median salary vs. median points scored, colored by quantile of team's cost per point
ggplot(points_salary, aes(x = median_points, y= median_salary)) + geom_point(aes(color = cost_quant, size = 20)) + geom_text(aes(label = team, y = median_salary + .2)) + labs( x = "Median points scored per team", y = "Median salary per team", title = "NBA Points vs. Salary", caption = "Colored by team's cost per point quantile") + guides(size = FALSE, color = guide_legend(title = "Cost per point quantiles"))
# barchart of cost per point by team
percentile = quantile(points_salary$cost_point, probs = c(0, 0.25, 0.5, 0.75, 1))
points_salary <- mutate(points_salary, cost_quant = factor(findInterval(points_salary$cost_point, percentile, all.inside = TRUE)))
levels(points_salary$cost_quant) <- c("<25", "25-50", "50-75", ">75")
ggplot(points_salary, aes(x = reorder(team, cost_point), y = cost_point, fill = cost_quant)) + geom_col() + coord_flip() + labs(y = "Cost per Point ($)", x = "Team", title = "Cost per Point Scored by NBA Teams") + geom_hline(yintercept = median(points_salary$cost_point), color = "red") + geom_text(aes(x = 4, y = median(points_salary$cost_point)), label = paste("Median cost per point: $", as.integer(median(points_salary$cost_point)), collapse = "")) + guides(color = guide_legend(title = "Cost per point percentiles")) + theme_bw()
# barchart of cost per point by team
percentile = quantile(points_salary$cost_point, probs = c(0, 0.25, 0.5, 0.75, 1))
points_salary <- mutate(points_salary, cost_quant = factor(findInterval(points_salary$cost_point, percentile, all.inside = TRUE)))
levels(points_salary$cost_quant) <- c("<25", "25-50", "50-75", ">75")
ggplot(points_salary, aes(x = reorder(team, cost_point), y = cost_point, fill = cost_quant)) + geom_col() + coord_flip() + labs(y = "Cost per Point ($)", x = "Team", title = "Cost per Point Scored by NBA Teams") + geom_hline(yintercept = median(points_salary$cost_point), color = "red") + geom_text(aes(x = 4, y = median(points_salary$cost_point)), label = paste("Median cost per point: $", as.integer(median(points_salary$cost_point)), collapse = "")) + guides(fill = guide_legend(title = "Cost per point percentiles")) + theme_bw()
# plot of median salary vs. median points scored, colored by quantile of team's cost per point
ggplot(points_salary, aes(x = median_points, y= median_salary)) + geom_point(aes(color = cost_quant, size = 20)) + geom_text(aes(label = team, y = median_salary + .2)) + labs( x = "Median points scored per team", y = "Median salary per team", title = "NBA Points vs. Salary", caption = "Colored by team's cost per point quantile") + guides(size = FALSE, color = guide_legend(title = "Cost per point percentiles"))
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(knitr)
setwd("~/School/Spring 2019/Stat 133/workout01/code")
# make shots data
library(dplyr)
library(readr)
iguodala <- read_csv("../data/andre-iguodala.csv", col_types = "fcfiiiffficii")
green <- read_csv("../data/draymond-green.csv", col_types = "fcfiiiffficii")
durant <- read_csv("../data/kevin-durant.csv", col_types = "fcfiiiffficii")
thompson <- read_csv("../data/klay-thompson.csv", col_types = "fcfiiiffficii")
curry <- read_csv("../data/stephen-curry.csv", col_types = "fcfiiiffficii")
iguodala <- mutate(iguodala, name = "Andre Iguodala")
green <- mutate(green, name = "Draymond Green")
durant <- mutate(durant, name = "Kevin Durant")
thompson <- mutate(thompson, name = "Klay Thompson")
curry <- mutate(curry, name = "Stephen Curry")
levels(iguodala$shot_made_flag) <- c("shot_no", "shot_yes")
levels(green$shot_made_flag) <- c("shot_no", "shot_yes")
levels(durant$shot_made_flag) <- c("shot_no", "shot_yes")
levels(thompson$shot_made_flag) <- c("shot_no", "shot_yes")
levels(curry$shot_made_flag) <- c("shot_no", "shot_yes")
iguodala <- mutate(iguodala, minute = ((period - 1) * 12) + (12 - minutes_remaining))
green <- mutate(green, minute = ((period - 1) * 12) + (12 - minutes_remaining))
durant <- mutate(durant, minute = ((period - 1) * 12) + (12 - minutes_remaining))
thompson <- mutate(thompson, minute = ((period - 1) * 12) + (12 - minutes_remaining))
curry <- mutate(curry, minute = ((period - 1) * 12) + (12 - minutes_remaining))
sink(file = "../output/andre-iguodala-summary.txt", append = FALSE)
summary(iguodala)
sink()
sink(file = "../output/draymond-green-summary.txt", append = FALSE)
summary(green)
sink()
sink(file = "../output/kevin-durant-summary.txt", append = FALSE)
summary(durant)
sink()
sink(file = "../output/klay-thompson-summary.txt", append = FALSE)
summary(thompson)
sink()
sink(file = "../output/stephen-curry-summary.txt", append = FALSE)
summary(curry)
sink()
shots_data <- rbind(iguodala, green, durant, thompson, curry)
write.csv(shots_data, file = "../data/shots-data.csv")
sink(file = "../output/shots-data-summary.txt", append = FALSE)
summary(shots_data)
sink()
# make shot charts
library(jpeg)
library(grid)
library(ggplot2)
court_file <- "../images/nba-court.jpg"
court_image <- rasterGrob(
readJPEG(court_file),
width = unit(1, "npc"),
height = unit(1, "npc"))
curry_shot_chart <- ggplot(curry) +
annotation_custom(court_image, -250, 250, -50, 420) +
geom_point(aes(x = x, y = y, color = shot_made_flag)) +
ylim(-50, 420) +
ggtitle("Shot Chart: Stephen Curry (2016 season)") +
theme_minimal()
ggsave("../images/stephen-curry-shot-chart.pdf", width=6.5, height=5)
durant_shot_chart <- ggplot(durant) +
annotation_custom(court_image, -250, 250, -50, 420) +
geom_point(aes(x = x, y = y, color = shot_made_flag)) +
ylim(-50, 420) +
ggtitle("Shot Chart: Kevin Durant (2016 season)") +
theme_minimal()
ggsave("../images/kevin-durant-shot-chart.pdf", width=6.5, height=5)
green_shot_chart <- ggplot(green) +
annotation_custom(court_image, -250, 250, -50, 420) +
geom_point(aes(x = x, y = y, color = shot_made_flag)) +
ylim(-50, 420) +
ggtitle("Shot Chart: Draymond Green (2016 season)") +
theme_minimal()
ggsave("../images/draymond-green-shot-chart.pdf", width=6.5, height=5)
iguodala_shot_chart <- ggplot(iguodala) +
annotation_custom(court_image, -250, 250, -50, 420) +
geom_point(aes(x = x, y = y, color = shot_made_flag)) +
ylim(-50, 420) +
ggtitle("Shot Chart: Andre Iguodala (2016 season)") +
theme_minimal()
ggsave("../images/andre-iguodala-shot-chart.pdf", width=6.5, height=5)
thompson_shot_chart <- ggplot(thompson) +
annotation_custom(court_image, -250, 250, -50, 420) +
geom_point(aes(x = x, y = y, color = shot_made_flag)) +
ylim(-50, 420) +
ggtitle("Shot Chart: Klay Thompson (2016 season)") +
theme_minimal()
ggsave("../images/klay-thompson-shot-chart.pdf", width=6.5, height=5)
gsw_shot_chart <- ggplot(shots_data) +
annotation_custom(court_image, -250, 250, -50, 420) +
geom_point(aes(x = x, y = y, color = shot_made_flag)) +
ylim(-50, 420) +
facet_wrap(~ name)
ggtitle("shot Charts for the Golden State Warriors (2016 season)") +
theme_minimal()
ggsave("../images/gsw-shot-charts.pdf", width = 8, height = 7)
ggsave("../images/gsw-shot-charts.png", width = 8, height = 7)
View(shots_data)
effective_shooting_2pt <- shots_data
eff_shoot_2pt <- shots_data
eff_shoot_2pt <- shots_data
eff_shoot_2pt <- eff_shoot_2pt %>%
filter(shot_type == "2 PT Field Goal") %>%
select(name, shot_made_flag) %>%
group_by(name) %>%
summarize(total = nrow(shot_made_flag), made = length(shot_made_flag == "shot_yes"), perc_made = made/total)
eff_shoot_2pt <- shots_data
eff_shoot_2pt <- eff_shoot_2pt %>%
filter(shot_type == "2 PT Field Goal") %>%
select(name, shot_made_flag) %>%
group_by(name) %>%
summarize(total = length(shot_made_flag), made = length(shot_made_flag == "shot_yes"), perc_made = made/total)
View(eff_shoot_2pt)
eff_shoot_2pt <- shots_data
eff_shoot_2pt <- eff_shoot_2pt %>%
filter(shot_type == "2 PT Field Goal") %>%
select(name, shot_made_flag) %>%
group_by(name) %>%
summarize(total = length(shot_made_flag), made = length(shot_made_flag == "shot_yes"), perc_made = made/total)
eff_shoot_2pt <- shots_data
eff_shoot_2pt <- eff_shoot_2pt %>%
filter(shot_type == "2 PT Field Goal") %>%
select(name, shot_made_flag) %>%
group_by(name)
eff_shoot_2pt <- shots_data
eff_shoot_2pt <- eff_shoot_2pt %>%
filter(shot_type == "2PT Field Goal") %>%
select(name, shot_made_flag) %>%
group_by(name) %>%
summarize(total = length(shot_made_flag), made = length(shot_made_flag == "shot_yes"), perc_made = made/total)
eff_shoot_2pt <- eff_shoot_2pt %>%
filter(shot_type == "2PT Field Goal") %>%
select(name, shot_made_flag) %>%
group_by(name, shot_made_flag) %>%
summarize(total = length(shot_made_flag), made = length(shot_made_flag == "shot_yes"), perc_made = made/total)
eff_shoot_2pt <- shots_data
eff_shoot_2pt <- eff_shoot_2pt %>%
filter(shot_type == "2PT Field Goal") %>%
select(name, shot_made_flag) %>%
group_by(name, shot_made_flag) %>%
summarize(total = length(shot_made_flag), made = length(shot_made_flag == "shot_yes"), perc_made = made/total)
n()
eff_shoot_2pt <- shots_data
eff_shoot_2pt <- eff_shoot_2pt %>%
filter(shot_type == "2PT Field Goal") %>%
select(name, shot_made_flag) %>%
group_by(name) %>%
summarize(total = length(shot_made_flag), made = length(shot_made_flag == "shot_yes"), perc_made = made/total)
eff_shoot_2pt <- eff_shoot_2pt %>%
filter(shot_type == "2PT Field Goal") %>%
select(name, shot_made_flag) %>%
group_by(name) %>%
summarize(total = length(shot_made_flag), made = length(shot_made_flag[shot_made_flag == "shot_yes"]), perc_made = made/total)
eff_shoot_2pt <- shots_data
eff_shoot_2pt <- eff_shoot_2pt %>%
filter(shot_type == "2PT Field Goal") %>%
select(name, shot_made_flag) %>%
group_by(name) %>%
summarize(total = length(shot_made_flag), made = length(shot_made_flag[shot_made_flag == "shot_yes"]), perc_made = made/total)
eff_shoot_2pt <- shots_data
select(name, shot_made_flag) %>%
summarize(total = length(shot_made_flag), made = length(shot_made_flag[shot_made_flag == "shot_yes"]), perc_made = round(made/total, digits = 2)
eff_shoot_2pt <- shots_data
eff_shoot_2pt <- shots_data
eff_shoot_2pt <- eff_shoot_2pt %>%
filter(shot_type == "2PT Field Goal") %>%
select(name, shot_made_flag) %>%
group_by(name) %>%
summarize(total = length(shot_made_flag), made = length(shot_made_flag[shot_made_flag == "shot_yes"]), perc_made = round(made/total, digits = 2))
eff_shoot_2pt <- shots_data
eff_shoot_2pt <- eff_shoot_2pt %>%
filter(shot_type == "2PT Field Goal") %>%
select(name, shot_made_flag) %>%
group_by(name) %>%
summarize(total = length(shot_made_flag), made = length(shot_made_flag[shot_made_flag == "shot_yes"]), perc_made = round(made/total, digits = 3))
eff_shoot_2pt <- shots_data
eff_shoot_2pt <- eff_shoot_2pt %>%
filter(shot_type == "2PT Field Goal") %>%
select(name, shot_made_flag) %>%
group_by(name) %>%
summarize(total = length(shot_made_flag), made = length(shot_made_flag[shot_made_flag == "shot_yes"]), perc_made = round(made/total, digits = 3)) %>%
arrange(desc(perc_made))
kable(eff_shoot_2pt, caption = "2PT Effective Shooting % by Player")
eff_shoot_2pt <- shots_data
eff_shoot_2pt <- eff_shoot_2pt %>%
filter(shot_type == "2PT Field Goal") %>%
select(name, shot_made_flag) %>%
group_by(name) %>%
summarize(total = length(shot_made_flag), made = length(shot_made_flag[shot_made_flag == "shot_yes"]), perc_made = round(made/total, digits = 3)) %>%
arrange(desc(perc_made))
kable(eff_shoot_2pt, caption = "2PT Effective Shooting % by Player")
setwd("~/School/Spring 2019/Stat 133/workout01/report")
<<make_shots_data>>
View(shots_data)
View(shots_data)
levels(shots_data$shot_type)
library(knitr)
library(dplyr)
read_chunk("../code/make-shots-data-script.R")
read_chunk("../code/make-shot-charts-script.R")
eff_shoot_3pt <- shots_data
eff_shoot_3pt <- eff_shoot_3pt %>%
filter(shot_type == "3PT Field Goal") %>%
select(name, shot_made_flag) %>%
group_by(name) %>%
summarize(total = length(shot_made_flag), made = length(shot_made_flag[shot_made_flag == "shot_yes"]), perc_made = round(made/total, digits = 3)) %>%
arrange(desc(perc_made))
kable(eff_shoot_3pt, caption = "3PT Effective Shooting % by Player")
eff_shoot <- shots_data
eff_shoot <- eff_shoot_3pt %>%
select(name, shot_made_flag) %>%
group_by(name) %>%
summarize(total = length(shot_made_flag), made = length(shot_made_flag[shot_made_flag == "shot_yes"]), perc_made = round(made/total, digits = 3)) %>%
arrange(desc(perc_made))
eff_shoot <- shots_data
eff_shoot <- eff_shoot %>%
select(name, shot_made_flag) %>%
group_by(name) %>%
summarize(total = length(shot_made_flag), made = length(shot_made_flag[shot_made_flag == "shot_yes"]), perc_made = round(made/total, digits = 3)) %>%
arrange(desc(perc_made))
kable(eff_shoot_3pt, caption = "3PT Effective Shooting % by Player")
table(shots_data$shot_type)
table(shots_data[shot_type[name == "Draymond Green"]])
table(shots_data[[name == "Draymond Green", shot_type]])
table(shots_data[name == "Draymond Green", shot_type])
View(green)
table(Green$shot_type)
table(green$shot_type)
eff_shoot <- shots_data
eff_shoot <- eff_shoot %>%
select(name, shot_made_flag) %>%
group_by(name) %>%
summarize(total = length(shot_made_flag), made = length(shot_made_flag[shot_made_flag == "shot_yes"]), perc_made = round(made/total, digits = 3)) %>%
arrange(desc(perc_made))
kable(eff_shoot_3pt, caption = "Overall Effective Shooting % by Player")
eff_shoot_3pt <- shots_data
eff_shoot_3pt <- eff_shoot_3pt %>%
filter(shot_type == "3PT Field Goal") %>%
select(name, shot_made_flag) %>%
group_by(name) %>%
summarize(total = length(shot_made_flag), made = length(shot_made_flag[shot_made_flag == "shot_yes"]), perc_made = round(made/total, digits = 3)) %>%
arrange(desc(perc_made))
kable(eff_shoot_3pt, caption = "3PT Effective Shooting % by Player")
eff_shoot_2pt <- shots_data
eff_shoot_2pt <- eff_shoot_2pt %>%
filter(shot_type == "2PT Field Goal") %>%
select(name, shot_made_flag) %>%
group_by(name) %>%
summarize(total = length(shot_made_flag), made = length(shot_made_flag[shot_made_flag == "shot_yes"]), perc_made = round(made/total, digits = 3)) %>%
arrange(desc(perc_made))
kable(eff_shoot_2pt, caption = "2PT Effective Shooting % by Player")
eff_shoot <- shots_data
eff_shoot <- eff_shoot %>%
filter(shot_type == "3PT Field Goal" | shot_type == "2PT Field Goal") %>%
select(name, shot_made_flag) %>%
group_by(name) %>%
summarize(total = length(shot_made_flag), made = length(shot_made_flag[shot_made_flag == "shot_yes"]), perc_made = round(made/total, digits = 3)) %>%
arrange(desc(perc_made))
kable(eff_shoot_3pt, caption = "Overall Effective Shooting % by Player")
eff_shoot <- eff_shoot %>%
select(name, shot_made_flag) %>%
group_by(name) %>%
summarize(total = n(), made = length(shot_made_flag[shot_made_flag == "shot_yes"]), perc_made = round(made/total, digits = 3)) %>%
arrange(desc(perc_made))
eff_shoot <- shots_data
eff_shoot <- eff_shoot %>%
select(name, shot_made_flag) %>%
group_by(name) %>%
summarize(total = n(), made = length(shot_made_flag[shot_made_flag == "shot_yes"]), perc_made = round(made/total, digits = 3)) %>%
arrange(desc(perc_made))
kable(eff_shoot_3pt, caption = "Overall Effective Shooting % by Player")
eff_shoot <- shots_data
eff_shoot <- eff_shoot %>%
select(name, shot_made_flag) %>%
group_by(name) %>%
summarize(total = length(shot_made_flag), made = length(shot_made_flag[shot_made_flag == "shot_yes"]), perc_made = round(made/total, digits = 3)) %>%
arrange(desc(perc_made))
kable(eff_shoot_3pt, caption = "Overall Effective Shooting % by Player")
eff_shoot <- shots_data
eff_shoot <- eff_shoot %>%
select(name, shot_made_flag) %>%
group_by(name) %>%
summarize(total = length(shot_made_flag), made = length(shot_made_flag[shot_made_flag == "shot_yes"]), perc_made = round(made/total, digits = 3)) %>%
arrange(desc(perc_made))
kable(eff_shoot, caption = "Overall Effective Shooting % by Player")
